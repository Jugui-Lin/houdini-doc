{"type": "root", "attrs": {"type": "node", "context": "sop", "internal": "block_end", "icon": "SOP/block_end", "tags": "tech, loop", "since": "14.5", "version": null, "namespace": null}, "body": [{"level": 0, "type": "title", "indent": 0, "text": ["Block End"], "extent": [0, 14]}, {"type": "summary", "indent": 0, "text": ["The end/output of a looping block."], "extent": [115, 157]}, {"type": "para", "indent": 0, "text": ["See ", {"scheme": null, "value": "/model/looping", "type": "link", "text": ["looping in geometry networks"], "fullpath": "/model/looping"}, " for general information on how to use this node and ", {"scheme": "Node", "value": "/nodes/sop/block_begin", "type": "link", "text": ["Block Begin"], "fullpath": "/nodes/sop/block_begin"}, "."], "extent": [157, 296]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Repetition mode vs. piecewise mode"], "extent": [296, 337], "body": [{"type": "para", "indent": 0, "text": ["The node will present a different interface based on whether it is working on pieces."], "extent": [337, 425]}, {"type": "para", "indent": 0, "text": ["If the node is in Auto Detect from Inputs, it will use this approach:"], "extent": [425, 496]}, {"type": "bullet_group", "body": [{"blevel": 2, "type": "bullet", "indent": 0, "text": ["When the Block Begin node referenced in the ", {"type": "ui", "text": ["Piece Block Path"]}, " parameter is set to ", {"type": "q", "text": ["Fetch piece"]}, ", or when the second input of this node is connected, the node is in ", {"type": "q", "text": ["piecewise"]}, " mode and will show parameters related to pieces. You do not need to set the number of iterations because it will automatically iterate over each piece."], "extent": [496, 830]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": ["Otherwise, the node is in ", {"type": "q", "text": ["repetition"]}, " mode and will show parameters allowing you to set the number of iterations."], "extent": [830, 948]}], "container": true}, {"type": "para", "indent": 0, "text": ["Otherwise, the Iteration Method controls the repetition mode."], "extent": [948, 1011]}]}, {"level": 1, "id": "parameters", "container": true, "type": "parameters_section", "indent": 0, "role": "section", "extent": [1011, 1023], "body": [{"type": "para", "indent": 0, "text": ["Iteration Method:"], "extent": [1023, 1043]}, {"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Iteration Method"], "extent": [1043, 1061], "body": [{"type": "dt_group", "body": [{"type": "dt", "indent": 4, "text": ["Auto Detect from Inputs"], "extent": [1061, 1090], "body": [{"type": "para", "indent": 8, "text": ["If the second input is present, the Piece iteration method is used\n        across that geometry.  Similarly, if the Piece Block Path exists,\n        the Piece Iteration method is used across the Piece Block\u2019s input.\n        If neither of these are the case, the Count method is used."], "extent": [1090, 1383]}], "container": true}, {"type": "dt", "indent": 4, "text": ["By Pieces"], "extent": [1383, 1398], "body": [{"type": "para", "indent": 8, "text": ["One iteration will be done for each piece in the template geometry.\n        If no template geometry is wired up, it is an error."], "extent": [1398, 1536]}], "container": true}, {"type": "dt", "indent": 4, "text": ["By Count"], "extent": [1536, 1550], "body": [{"type": "para", "indent": 8, "text": ["A fixed number of iterations is performed according to the Iterations\n        parameter."], "extent": [1550, 1648]}], "container": true}], "container": true}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Gather Method"], "extent": [1648, 1663], "body": [{"type": "dt_group", "body": [{"type": "dt", "indent": 4, "text": ["Feedback Each Iteration"], "extent": [1663, 1692], "body": [{"type": "para", "indent": 8, "text": ["Outputs the geometry from the last iteration of the loop. You would use this when the Block Begin node is set to ", {"type": "q", "text": ["Fetch feedback"]}, ", so the loop is accumulating geometry at each step and you just want the end result."], "extent": [1692, 1924]}], "container": true}, {"type": "dt", "indent": 4, "text": ["Merge Each Iteration"], "extent": [1924, 1950], "body": [{"type": "para", "indent": 8, "text": ["Records the geometry from each iteration, and merges them together at the end. You would use this when the Block Begin node is set to ", {"type": "q", "text": ["Fetch piece"]}, ", so the loop is only modifying one piece at a time and you need to merge them together at the end."], "extent": [1950, 2206]}], "container": true}], "container": true}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Iterations"], "extent": [2206, 2218], "body": [{"type": "para", "indent": 4, "text": ["The number of times to cook the loop. Not available in piecewise mode."], "extent": [2218, 2294]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Start Value"], "extent": [2294, 2307], "body": [{"type": "para", "indent": 4, "text": ["The value of the ", {"type": "code", "text": ["value"]}, " metadata attribute on the first iteration. See ", {"scheme": null, "value": "/model/looping#metadata", "type": "link", "text": ["the looping documentation"], "fullpath": "/model/looping#metadata", "fragment": "#metadata"}, " for how to use this. Not available in piecewise mode."], "extent": [2307, 2490]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Increment"], "extent": [2490, 2501], "body": [{"type": "para", "indent": 4, "text": ["The amount to add to the ", {"type": "code", "text": ["value"]}, " metadata attribute after each iteration. See ", {"scheme": null, "value": "/model/looping#metadata", "type": "link", "text": ["the looping documentation"], "fullpath": "/model/looping#metadata", "fragment": "#metadata"}, " for how to use this. Not available in piecewise mode."], "extent": [2501, 2690]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Piece Elements"], "extent": [2690, 2706], "body": [{"type": "para", "indent": 4, "text": ["In piecewise mode, whether to loop over primitives or points. This controls whether the piece attribute will be a point or primitive attribute. Not available in repetition mode."], "extent": [2706, 2889]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Piece Attribute"], "extent": [2889, 2906], "body": [{"type": "para", "indent": 4, "text": ["The name of a partition attribute defining pieces, where each point/primitive where the attribute has the same value is considered part of the same piece. Several tools such as ", {"scheme": null, "value": "/shelf/shatter", "type": "link", "text": ["Shatter"], "fullpath": "/shelf/shatter"}, " create this type of attribute for you. If not given, the node will simply loop over every point/primitive in the input. Not available in repetition mode."], "extent": [2906, 3275]}, {"type": "para", "indent": 4, "text": ["Partition attributes can only be integer or strings. This will be a point or primitive attribute depending on the value of ", {"type": "ui", "text": ["Piece element"]}, "."], "extent": [3275, 3426]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Max Iterations"], "extent": [3426, 3442], "body": [{"type": "para", "indent": 4, "text": ["Only allow a maximum of this number of iterations. This can be useful for testing and debugging. You can also use it in piecewise mode to guard against huge input geometry."], "extent": [3442, 3620]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Default Block Path"], "extent": [3620, 3640], "body": [{"type": "para", "indent": 4, "text": ["The path to a Block Begin node. If the number of iterations is 0, output this Block Begin node\u2019s input."], "extent": [3640, 3749]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Piece Block Path"], "extent": [3749, 3767], "body": [{"type": "para", "indent": 4, "text": ["The path to a Block Begin node, from which to get pieces. Alternatively you can connect the geometry containing pieces to this node\u2019s second input. Either switches the node to ", {"type": "q", "text": ["piecewise"]}, " mode."], "extent": [3767, 3966]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Reset Cached Pass"], "extent": [3966, 3985], "body": [{"type": "para", "indent": 4, "text": ["After cooking, this node caches the output of the last iteration. This lets you debug the last iteration by moving the display flag around inside the loop. Clicking this button clears the cache, so until the node cooks again the nodes show the initial state."], "extent": [3985, 4249]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Single Pass"], "extent": [4249, 4262], "body": [{"type": "para", "indent": 4, "text": ["Runs a single iteration at the given offset. This is useful for debugging piecewise loops, showing the output of an individual piece/iteration."], "extent": [4262, 4411]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Stop Condition"], "extent": [4411, 4427], "body": [{"type": "para", "indent": 4, "text": ["If this parameter is ", {"type": "code", "text": ["1"]}, " at the start of an iteration, looping stops. You can write an expression here to test some condition. For example, you could set a threshold for the number of polygons in a feedback loop."], "extent": [4427, 4645]}, {"type": "para", "indent": 4, "text": ["If the stop condition triggers before the first iteration, it is as if ", {"type": "ui", "text": ["Max iterations"]}, " was ", {"type": "code", "text": ["0"]}, ", and this node outputs the input to the ", {"type": "ui", "text": ["Default block path"]}, " node."], "extent": [4645, 4817]}], "container": true, "role": "item"}], "container": true, "role": "item_group"}], "text": "Parameters"}, {"level": 1, "id": "inputs", "container": true, "type": "inputs_section", "indent": 0, "role": "section", "extent": [4817, 4825], "body": [{"type": "dt_group", "body": [{"type": "dt", "indent": 0, "text": ["Nodes to Iterate Over"], "extent": [4825, 4849], "body": [{"type": "para", "indent": 8, "text": ["This network chain will be re-evaluated for each iteration.\n        Upstream Block Begin SOPs will be dirtied each pass."], "extent": [4849, 4979]}], "container": true}, {"type": "dt", "indent": 0, "text": ["Geometry Pieces to Loop Over"], "extent": [4979, 5009], "body": [{"type": "para", "indent": 4, "text": ["A source for pieces to iterate over. Alternatively you can use the ", {"type": "ui", "text": ["Piece block path"]}, " parameter to specify the source. This should be a Block Begin node set to ", {"type": "q", "text": ["Fetch piece"]}, "."], "extent": [5009, 5191]}], "container": true}, {"type": "dt", "indent": 0, "text": ["Multithread when Compiled"], "extent": [5191, 5218], "body": [{"type": "para", "indent": 4, "text": ["If this for-loop is inside of a compiled block, it might be possible to run\n    each pass on a separate thread.  It has to be in a Merge Each Iteration\n    mode and has to have no Feedback inputs.   If this is fulfilled, a separate\n    task can be created for each pass, allowing singlethreaded operations to\n    use multiple cores."], "extent": [5218, 5556]}, {"type": "para", "indent": 4, "text": ["Note if the operations in the loop are already multithreaded there may be\n    little gain, and the overhead of starting tasks may even make it slower.\n    Likewise, if the operations are very fast it might take longer to setup\n    tasks than is gained.  In particular, it usually is only needed to\n    multithread the outermost of a set of for loops."], "extent": [5556, 5912]}], "container": true}], "container": true}], "text": "Inputs"}, {"level": 1, "id": "related", "container": true, "type": "related_section", "indent": 0, "role": "section", "extent": [5912, 5921], "body": [{"type": "bullet_group", "body": [{"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": null, "value": "/model/looping", "type": "link", "text": ["Looping in geometry networks"], "fullpath": "/model/looping"}], "extent": [5921, 5970]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/block_begin", "type": "link", "text": "", "fullpath": "/nodes/sop/block_begin"}], "extent": [5970, 5995]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/copy", "type": "link", "text": "", "fullpath": "/nodes/sop/copy"}], "extent": [5995, 6013]}], "container": true}], "text": "Related"}], "title": ["Block End"], "summary": ["The end/output of a looping block."]}